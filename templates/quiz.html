{% extends 'layout.html' %}
{% block title %}Question - F1 Tire Quiz{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">

<!-- Quiz title and question inside box -->
<div class="text-center">
  <div class="quiz-block d-inline-block mb-4">
    <h1>Quiz â€” Question {{ question_number }} of {{ total_questions }}</h1>
    <hr class="quiz-divider">
    <h2>{{ question["question"] }}</h2>
  </div>

  {% if question.image %}
    {% if question.quiz_id == "1" %}
      <img src="{{ url_for('static', filename='images/' ~ question.image) }}" 
           alt="Question image" class="img-fluid d-block mx-auto my-4" style="max-width: 400px;">
    {% elif question.quiz_id == "2" %}
      <img src="{{ url_for('static', filename='images/' ~ question.image) }}" 
           alt="Question image" class="img-fluid d-block mx-auto my-4" style="max-width: 700px;">
    {% else %}
      <img src="{{ url_for('static', filename='images/' ~ question.image) }}" 
           alt="Question image" class="img-fluid d-block mx-auto my-4" style="max-width: 500px;">
    {% endif %}
  {% endif %}
</div>

<!-- Quiz form and options -->
<form method="POST" class="mt-4" id="quiz-form">
  <div class="row">
    {% for option in question["options"] %}
      {% set selected_class = '' %}
      {% set icon = '' %}

      {% if show_feedback %}
        {% if option.label == selected %}
          {% if is_correct %}
            {% set selected_class = 'correct' %}
            {% set icon = 'check.png' %}
          {% else %}
            {% set selected_class = 'incorrect' %}
            {% set icon = 'x.png' %}
          {% endif %}
        {% elif option.label == question.correct and not is_correct %}
          {% set selected_class = 'correct' %}
          {% set icon = 'check.png' %}
        {% endif %}
      {% endif %}

      <div class="col-md-6 mb-3">
        <label class="quiz-option {{ selected_class }}">
          <input type="radio" name="answer" value="{{ option.label }}" class="d-none" {% if option.label == selected %}checked{% endif %}>
          <div class="quiz-box text-center font-weight-bold">
            {{ option.label }}
            {% if icon %}
              <img src="{{ url_for('static', filename='images/' ~ icon) }}" alt="Feedback" style="height: 20px; margin-left: 10px;">
            {% endif %}
            {% if option.img %}
              <div class="mt-2">
                <img src="{{ url_for('static', filename='images/' ~ option.img) }}" alt="option image" style="height: 40px; margin-top: 10px;">
              </div>
            {% endif %}
          </div>
        </label>
      </div>
    {% endfor %}
  </div>

  {% if errors.answer %}
    <div class="alert alert-danger">{{ errors.answer }}</div>
  {% endif %}

  {% if not show_feedback %}
    <div class="text-center">
      <button type="submit" class="btn btn-primary mt-3">Submit Answer</button>
    </div>
  {% endif %}
</form>

<!-- Feedback block -->
{% if show_feedback %}
  <div class="text-center mt-4">
    <a href="{{ url_for('quiz', quiz_id=next_question) }}" class="btn btn-success mt-3">Next Question</a>
  </div>
{% endif %}
{% endblock %}
